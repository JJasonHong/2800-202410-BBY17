<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%- data[0].title %></title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #capsule-pics {
            box-shadow: 2px 2px 5px 2px rgb(0 0 0 / 20%);
        }

        .media-container {
            text-align: center;
            margin-bottom: 20px;
        }

        .img, .video {
            max-width: 80%;
            cursor: zoom-in;
            z-index: 1;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        /* Code referenced from https://www.youtube.com/watch?v=cb8NbWz5plg */
        #zoomed-img {
            display: none;
            border: 7px solid #916fe0;
            z-index: 900;
            cursor: zoom-out;
            position: fixed;
            max-height: 90%;
            left: 0;
            right: 0;
            margin-left: auto;
            margin-right: auto;
        }

        /* Referenced from https://codepen.io/srikarg/pen/AWZLyq */
        #dim {
            display: none;
            background: #000;
            opacity: 0.5;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100;
        }

        .caption {
            margin-top: 10px;
            font-size: 1.25rem;
        }
    </style>
</head>

<body>
    <div id="dim" onclick="unfocus()"></div>
    <%- include("templates/header") %>
    <div class="container py-2" id="capsule-pics">
        <div class="col">
            <h2 class="text-center py-3"><%- data[0].title %></h2>
            <h3 class="text-center"><%- data[0].capsuleCaption %></h3>
            <img id="zoomed-img" class="unfocused" onclick="unfocus()">
            <% for(let i = 0; i < data[0].images.length; i++) { %>
                <div class="media-container">
                    <% if (data[0].images[i].type.startsWith("image/")) { %>
                        <img src="<%- data[0].images[i].url %>" class="img" onclick='b("<%- data[0].images[i].url %>")'>
                    <% } else if (data[0].images[i].type.startsWith("video/")) { %>
                        <video class="video" controls onclick='b("<%- data[0].images[i].url %>")'>
                            <source src="<%- data[0].images[i].url %>" type="<%- data[0].images[i].type %>">
                        </video>
                    <% } %>
                    <p class="caption"><%- data[0].images[i].caption %></p>
                </div>
            <% } %>
        </div>
    </div>

    <script>
        function b(src) {
            document.getElementById('zoomed-img').src = src;
            document.getElementById('dim').style.display = "block";
            document.getElementById('zoomed-img').style.display = "block";
        }

        function unfocus() {
            document.getElementById('dim').style.display = "none";
            document.getElementById('zoomed-img').style.display = "none";
        }
    </script>
    <%- include("templates/footer") %>
</body>

</html>
